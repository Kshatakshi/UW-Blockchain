{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"C:/Users/Lenovo/uw/UW-Blockchain/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\Lenovo\\\\uw\\\\UW-Blockchain\\\\pages\\\\organizations\\\\requests\\\\index.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from \"react\";\nimport { Link } from \"../../../routes\";\nimport { Button, Table, Icon } from \"semantic-ui-react\";\nimport web3 from \"../../../ethereum/web3\";\nimport Layout from \"../../../components/Layout\";\nimport Organization from \"../../../ethereum/organization\";\nimport RenderRow from \"../../../components/RenderRow\";\nimport Float from \"../../../components/Image/svg.svg\";\nimport Float2 from '../../../components/Image/blockchain.png';\n\nvar ViewRequests = /*#__PURE__*/function (_React$Component) {\n  _inherits(ViewRequests, _React$Component);\n\n  var _super = _createSuper(ViewRequests);\n\n  function ViewRequests() {\n    var _this;\n\n    _classCallCheck(this, ViewRequests);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      requests: []\n    });\n\n    return _this;\n  }\n\n  _createClass(ViewRequests, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var accounts, requests;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return web3.eth.getAccounts();\n\n              case 2:\n                accounts = _context.sent;\n                console.log(accounts);\n                requests = this.props.requests.filter(function (request, index) {\n                  if (request.complete || accounts[0] == _this2.props.manager) return true;\n                  return _this2.props.reqApprovers[index].indexOf(accounts[0]) != -1;\n                });\n                this.setState({\n                  requests: requests\n                });\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"renderRows\",\n    value: function renderRows() {\n      var _this3 = this;\n\n      return this.state.requests.map(function (request, index) {\n        return __jsx(RenderRow, {\n          id: index,\n          request: request,\n          key: index,\n          approversCount: request.numOfAllowedApprovers,\n          address: _this3.props.address,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 9\n          }\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var Header = Table.Header,\n          Row = Table.Row,\n          HeaderCell = Table.HeaderCell,\n          Body = Table.Body;\n      return __jsx(\"div\", {\n        style: {\n          backgroundImage: \"url(\\\"https://i.pinimg.com/564x/cc/a1/f1/cca1f16b945651b503ccc55b6536aeb5.jpg\\\")\",\n          height: \"100vh\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 7\n        }\n      }, __jsx(Layout, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 7\n        }\n      }, __jsx(\"div\", {\n        style: {\n          display: 'flex',\n          flexDirection: 'row',\n          justifyContent: 'space-between',\n          position: 'relative'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 9\n        }\n      }, __jsx(\"img\", {\n        className: \"bg\",\n        style: {\n          marginLeft: '-7%'\n        },\n        src: Float,\n        alt: \"logo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 9\n        }\n      }), __jsx(\"img\", {\n        className: \"bg2\",\n        src: Float2,\n        alt: \"logo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 9\n        }\n      }), __jsx(\"img\", {\n        className: \"bg3\",\n        src: Float2,\n        alt: \"logo\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 9\n        }\n      })), __jsx(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 9\n        }\n      }, __jsx(\"div\", {\n        style: {\n          position: 'absolute',\n          marginTop: '-60vh',\n          width: '80%'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 9\n        }\n      }, __jsx(Link, {\n        route: \"/organizations/\".concat(this.props.address, \"/requests/new\"),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 13\n        }\n      }, __jsx(\"a\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }\n      }, __jsx(Button, {\n        floated: \"right\",\n        style: {\n          backgroundColor: '#55BCC9'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }\n      }, \"Add Request\"))), __jsx(Link, {\n        route: \"/organizations/\".concat(this.props.address),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }\n      }, __jsx(\"a\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 15\n        }\n      }, __jsx(Button, {\n        icon: true,\n        labelPosition: \"left\",\n        floated: \"right\",\n        style: {\n          backgroundColor: '#55BCC9'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 17\n        }\n      }, __jsx(Icon, {\n        name: \"left arrow\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 19\n        }\n      }), \"Back\"))), __jsx(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }\n      }, \"Requests\"), __jsx(Table, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }\n      }, __jsx(Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 15\n        }\n      }, __jsx(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 17\n        }\n      }, __jsx(HeaderCell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 19\n        }\n      }, \"ID\"), __jsx(HeaderCell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 19\n        }\n      }, \"Description\"), __jsx(HeaderCell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 19\n        }\n      }, \"Recipient\"), __jsx(HeaderCell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 19\n        }\n      }, \"Amount\"), __jsx(HeaderCell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 19\n        }\n      }, \"Approvals\"), __jsx(HeaderCell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 19\n        }\n      }, \"Approve\"), __jsx(HeaderCell, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 19\n        }\n      }, \"Finalize\"))), __jsx(Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 15\n        }\n      }, this.renderRows())), __jsx(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }\n      }, \"Found \", this.state.requests.length, \" requests\")))));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(props) {\n        var address, accounts, organization, requestCount, approverCount, manager, requests, reqApprovers;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                address = props.query.address;\n                _context3.next = 3;\n                return web3.eth.getAccounts();\n\n              case 3:\n                accounts = _context3.sent;\n                _context3.next = 6;\n                return Organization(address);\n\n              case 6:\n                organization = _context3.sent;\n                _context3.next = 9;\n                return organization.methods.getRequestsCount().call();\n\n              case 9:\n                requestCount = _context3.sent;\n                _context3.next = 12;\n                return organization.methods.approversCount().call();\n\n              case 12:\n                approverCount = _context3.sent;\n                _context3.next = 15;\n                return organization.methods.manager().call();\n\n              case 15:\n                manager = _context3.sent;\n                _context3.next = 18;\n                return Promise.all(Array(parseInt(requestCount)).fill().map(function (element, index) {\n                  return organization.methods.requests(index).call();\n                }));\n\n              case 18:\n                requests = _context3.sent;\n                _context3.next = 21;\n                return Promise.all(requests.map( /*#__PURE__*/function () {\n                  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(request, index) {\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _context2.next = 2;\n                            return Promise.all(Array(parseInt(request.numOfAllowedApprovers)).fill().map(function (ele, index) {\n                              return organization.methods.reqApprovers(parseInt(request.id), index).call();\n                            }));\n\n                          case 2:\n                            return _context2.abrupt(\"return\", _context2.sent);\n\n                          case 3:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  }));\n\n                  return function (_x2, _x3) {\n                    return _ref.apply(this, arguments);\n                  };\n                }()));\n\n              case 21:\n                reqApprovers = _context3.sent;\n                console.log(accounts);\n                console.log(reqApprovers);\n                return _context3.abrupt(\"return\", {\n                  address: address,\n                  requests: requests,\n                  approverCount: approverCount,\n                  reqApprovers: reqApprovers,\n                  manager: manager,\n                  requestCount: requestCount\n                });\n\n              case 25:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return ViewRequests;\n}(React.Component);\n\nexport default ViewRequests;","map":{"version":3,"sources":["C:/Users/Lenovo/uw/UW-Blockchain/pages/organizations/requests/index.js"],"names":["React","Link","Button","Table","Icon","web3","Layout","Organization","RenderRow","Float","Float2","ViewRequests","requests","eth","getAccounts","accounts","console","log","props","filter","request","index","complete","manager","reqApprovers","indexOf","setState","state","map","numOfAllowedApprovers","address","Header","Row","HeaderCell","Body","backgroundImage","height","display","flexDirection","justifyContent","position","marginLeft","marginTop","width","backgroundColor","renderRows","length","query","organization","methods","getRequestsCount","call","requestCount","approversCount","approverCount","Promise","all","Array","parseInt","fill","element","ele","id","Component"],"mappings":";;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,SACEC,MADF,EAEEC,KAFF,EAGEC,IAHF,QAIO,mBAJP;AAKA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,MAAP,MAAmB,4BAAnB;AACA,OAAOC,YAAP,MAAyB,gCAAzB;AACA,OAAOC,SAAP,MAAsB,+BAAtB;AACA,OAAOC,KAAP,MAAkB,mCAAlB;AACA,OAAOC,MAAP,MAAmB,0CAAnB;;IAEMC,Y;;;;;;;;;;;;;;;;4DACI;AACNC,MAAAA,QAAQ,EAAE;AADJ,K;;;;;;;;;;;;;;;;;uBAuCiBP,IAAI,CAACQ,GAAL,CAASC,WAAT,E;;;AAAjBC,gBAAAA,Q;AACNC,gBAAAA,OAAO,CAACC,GAAR,CAAYF,QAAZ;AACIH,gBAAAA,Q,GAAW,KAAKM,KAAL,CAAWN,QAAX,CAAoBO,MAApB,CAA2B,UAACC,OAAD,EAAUC,KAAV,EAAoB;AAC5D,sBAAID,OAAO,CAACE,QAAR,IAAoBP,QAAQ,CAAC,CAAD,CAAR,IAAe,MAAI,CAACG,KAAL,CAAWK,OAAlD,EAA2D,OAAO,IAAP;AAC3D,yBAAO,MAAI,CAACL,KAAL,CAAWM,YAAX,CAAwBH,KAAxB,EAA+BI,OAA/B,CAAuCV,QAAQ,CAAC,CAAD,CAA/C,KAAuD,CAAC,CAA/D;AACD,iBAHc,C;AAKf,qBAAKW,QAAL,CAAc;AACZd,kBAAAA,QAAQ,EAAEA;AADE,iBAAd;;;;;;;;;;;;;;;;;;iCAKW;AAAA;;AACX,aAAO,KAAKe,KAAL,CAAWf,QAAX,CAAoBgB,GAApB,CAAwB,UAACR,OAAD,EAAUC,KAAV,EAAoB;AACjD,eACE,MAAC,SAAD;AACE,UAAA,EAAE,EAAEA,KADN;AAEE,UAAA,OAAO,EAAED,OAFX;AAGE,UAAA,GAAG,EAAEC,KAHP;AAIE,UAAA,cAAc,EAAED,OAAO,CAACS,qBAJ1B;AAKE,UAAA,OAAO,EAAE,MAAI,CAACX,KAAL,CAAWY,OALtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AASD,OAVM,CAAP;AAWD;;;6BAEQ;AAAA,UACCC,MADD,GACmC5B,KADnC,CACC4B,MADD;AAAA,UACSC,GADT,GACmC7B,KADnC,CACS6B,GADT;AAAA,UACcC,UADd,GACmC9B,KADnC,CACc8B,UADd;AAAA,UAC0BC,IAD1B,GACmC/B,KADnC,CAC0B+B,IAD1B;AAEP,aACE;AAAK,QAAA,KAAK,EAAE;AAACC,UAAAA,eAAe,oFAAhB;AAAmGC,UAAAA,MAAM,EAAC;AAA1G,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAIE;AAAK,QAAA,KAAK,EAAE;AAACC,UAAAA,OAAO,EAAE,MAAV;AAAkBC,UAAAA,aAAa,EAAE,KAAjC;AAAwCC,UAAAA,cAAc,EAAC,eAAvD;AAAwEC,UAAAA,QAAQ,EAAE;AAAlF,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA;AAAK,QAAA,SAAS,EAAC,IAAf;AAAoB,QAAA,KAAK,EAAE;AAACC,UAAAA,UAAU,EAAE;AAAb,SAA3B;AAAgD,QAAA,GAAG,EAAEhC,KAArD;AAA4D,QAAA,GAAG,EAAC,MAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADA,EAEA;AAAK,QAAA,SAAS,EAAC,KAAf;AAAqB,QAAA,GAAG,EAAEC,MAA1B;AAAkC,QAAA,GAAG,EAAC,MAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFA,EAGA;AAAK,QAAA,SAAS,EAAC,KAAf;AAAqB,QAAA,GAAG,EAAEA,MAA1B;AAAkC,QAAA,GAAG,EAAC,MAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHA,CAJF,EASE;AAAK,QAAA,KAAK,EAAE;AAAC2B,UAAAA,OAAO,EAAE,MAAV;AAAkBE,UAAAA,cAAc,EAAC;AAAjC,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA;AAAK,QAAA,KAAK,EAAE;AAACC,UAAAA,QAAQ,EAAE,UAAX;AAAuBE,UAAAA,SAAS,EAAE,OAAlC;AAA2CC,UAAAA,KAAK,EAAC;AAAjD,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,MAAC,IAAD;AAAM,QAAA,KAAK,2BAAoB,KAAKzB,KAAL,CAAWY,OAA/B,kBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,MAAD;AAAQ,QAAA,OAAO,EAAC,OAAhB;AAAwB,QAAA,KAAK,EAAE;AAACc,UAAAA,eAAe,EAAC;AAAjB,SAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,CADF,CADJ,EAQI,MAAC,IAAD;AAAM,QAAA,KAAK,2BAAoB,KAAK1B,KAAL,CAAWY,OAA/B,CAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,MAAD;AAAQ,QAAA,IAAI,MAAZ;AAAa,QAAA,aAAa,EAAC,MAA3B;AAAkC,QAAA,OAAO,EAAC,OAA1C;AAAkD,QAAA,KAAK,EAAE;AAACc,UAAAA,eAAe,EAAC;AAAjB,SAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,IAAD;AAAM,QAAA,IAAI,EAAC,YAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,SADF,CADF,CARJ,EAgBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAhBJ,EAiBI,MAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,EAEE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAFF,EAGE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAHF,EAIE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF,EAKE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBALF,EAME,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBANF,EAOE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAPF,CADF,CADF,EAYE,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAO,KAAKC,UAAL,EAAP,CAZF,CAjBJ,EA+BI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAW,KAAKlB,KAAL,CAAWf,QAAX,CAAoBkC,MAA/B,cA/BJ,CADA,CATF,CADA,CADF;AAiDD;;;;wGAjH4B5B,K;;;;;;AACnBY,gBAAAA,O,GAAYZ,KAAK,CAAC6B,K,CAAlBjB,O;;uBACezB,IAAI,CAACQ,GAAL,CAASC,WAAT,E;;;AAAjBC,gBAAAA,Q;;uBACqBR,YAAY,CAACuB,OAAD,C;;;AAAjCkB,gBAAAA,Y;;uBACqBA,YAAY,CAACC,OAAb,CAAqBC,gBAArB,GAAwCC,IAAxC,E;;;AAArBC,gBAAAA,Y;;uBACsBJ,YAAY,CAACC,OAAb,CAAqBI,cAArB,GAAsCF,IAAtC,E;;;AAAtBG,gBAAAA,a;;uBACgBN,YAAY,CAACC,OAAb,CAAqB1B,OAArB,GAA+B4B,IAA/B,E;;;AAAhB5B,gBAAAA,O;;uBAGWgC,OAAO,CAACC,GAAR,CACfC,KAAK,CAACC,QAAQ,CAACN,YAAD,CAAT,CAAL,CACGO,IADH,GAEG/B,GAFH,CAEO,UAACgC,OAAD,EAAUvC,KAAV,EAAoB;AACvB,yBAAO2B,YAAY,CAACC,OAAb,CAAqBrC,QAArB,CAA8BS,KAA9B,EAAqC8B,IAArC,EAAP;AACD,iBAJH,CADe,C;;;AAAjBvC,gBAAAA,Q;;uBAQ2B2C,OAAO,CAACC,GAAR,CACzB5C,QAAQ,CAACgB,GAAT;AAAA,sFAAa,kBAAOR,OAAP,EAAgBC,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACEkC,OAAO,CAACC,GAAR,CACXC,KAAK,CAACC,QAAQ,CAACtC,OAAO,CAACS,qBAAT,CAAT,CAAL,CACG8B,IADH,GAEG/B,GAFH,CAEO,UAACiC,GAAD,EAAMxC,KAAN,EAAgB;AACnB,qCAAO2B,YAAY,CAACC,OAAb,CACJzB,YADI,CACSkC,QAAQ,CAACtC,OAAO,CAAC0C,EAAT,CADjB,EAC+BzC,KAD/B,EAEJ8B,IAFI,EAAP;AAGD,6BANH,CADW,CADF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAb;;AAAA;AAAA;AAAA;AAAA,oBADyB,C;;;AAArB3B,gBAAAA,Y;AAaNR,gBAAAA,OAAO,CAACC,GAAR,CAAYF,QAAZ;AACAC,gBAAAA,OAAO,CAACC,GAAR,CAAYO,YAAZ;kDACO;AAAEM,kBAAAA,OAAO,EAAPA,OAAF;AAAWlB,kBAAAA,QAAQ,EAARA,QAAX;AAAqB0C,kBAAAA,aAAa,EAAbA,aAArB;AAAoC9B,kBAAAA,YAAY,EAAZA,YAApC;AAAkDD,kBAAAA,OAAO,EAAPA,OAAlD;AAA2D6B,kBAAAA,YAAY,EAAZA;AAA3D,iB;;;;;;;;;;;;;;;;;;;EApCgBpD,KAAK,CAAC+D,S;;AAwHjC,eAAepD,YAAf","sourcesContent":["import React from \"react\";\r\nimport { Link } from \"../../../routes\";\r\nimport {\r\n  Button,\r\n  Table,\r\n  Icon\r\n} from \"semantic-ui-react\";\r\nimport web3 from \"../../../ethereum/web3\";\r\nimport Layout from \"../../../components/Layout\";\r\nimport Organization from \"../../../ethereum/organization\";\r\nimport RenderRow from \"../../../components/RenderRow\";\r\nimport Float from \"../../../components/Image/svg.svg\";\r\nimport Float2 from '../../../components/Image/blockchain.png';\r\n\r\nclass ViewRequests extends React.Component {\r\n  state = {\r\n    requests: []\r\n  };\r\n  static async getInitialProps(props) {\r\n    const { address } = props.query;\r\n    const accounts = await web3.eth.getAccounts();\r\n    const organization = await Organization(address);\r\n    const requestCount = await organization.methods.getRequestsCount().call();\r\n    const approverCount = await organization.methods.approversCount().call();\r\n    const manager = await organization.methods.manager().call();\r\n\r\n    let requests;\r\n    requests = await Promise.all(\r\n      Array(parseInt(requestCount))\r\n        .fill()\r\n        .map((element, index) => {\r\n          return organization.methods.requests(index).call();\r\n        })\r\n    );\r\n\r\n    const reqApprovers = await Promise.all(\r\n      requests.map(async (request, index) => {\r\n        return await Promise.all(\r\n          Array(parseInt(request.numOfAllowedApprovers))\r\n            .fill()\r\n            .map((ele, index) => {\r\n              return organization.methods\r\n                .reqApprovers(parseInt(request.id), index)\r\n                .call();\r\n            })\r\n        );\r\n      })\r\n    );\r\n    console.log(accounts);\r\n    console.log(reqApprovers);\r\n    return { address, requests, approverCount, reqApprovers, manager ,requestCount };\r\n  }\r\n  \r\n  async componentDidMount() {\r\n    const accounts = await web3.eth.getAccounts();\r\n    console.log(accounts);\r\n    let requests = this.props.requests.filter((request, index) => {\r\n      if (request.complete || accounts[0] == this.props.manager) return true;\r\n      return this.props.reqApprovers[index].indexOf(accounts[0]) != -1;\r\n    });\r\n\r\n    this.setState({\r\n      requests: requests\r\n    });\r\n  }\r\n\r\n  renderRows() {\r\n    return this.state.requests.map((request, index) => {\r\n      return (\r\n        <RenderRow\r\n          id={index}\r\n          request={request}\r\n          key={index}\r\n          approversCount={request.numOfAllowedApprovers}\r\n          address={this.props.address}\r\n        />\r\n      );\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { Header, Row, HeaderCell, Body } = Table;\r\n    return (\r\n      <div style={{backgroundImage:`url(\"https://i.pinimg.com/564x/cc/a1/f1/cca1f16b945651b503ccc55b6536aeb5.jpg\")`, height:\"100vh\"}}>\r\n      <Layout>\r\n        {/* <Dimmer active inverted>\r\n          <Loader size=\"large\">Processing Request ...</Loader>\r\n        </Dimmer> */}\r\n        <div style={{display: 'flex', flexDirection: 'row', justifyContent:'space-between', position: 'relative'}}>\r\n        <img className=\"bg\" style={{marginLeft: '-7%'}} src={Float} alt='logo'/>\r\n        <img className=\"bg2\" src={Float2} alt='logo'/>\r\n        <img className=\"bg3\" src={Float2} alt='logo'/>\r\n        </div>\r\n        <div style={{display: 'flex', justifyContent:'center'}}>\r\n        <div style={{position: 'absolute', marginTop: '-60vh', width:'80%'}}>\r\n            <Link route={`/organizations/${this.props.address}/requests/new`}>\r\n              <a>\r\n                <Button floated=\"right\" style={{backgroundColor:'#55BCC9'}}>\r\n                  Add Request\r\n                </Button>\r\n              </a>\r\n            </Link>\r\n            <Link route={`/organizations/${this.props.address}`}>\r\n              <a>\r\n                <Button icon labelPosition=\"left\" floated=\"right\" style={{backgroundColor:'#55BCC9'}}>\r\n                  <Icon name=\"left arrow\" />\r\n                  Back\r\n                </Button>\r\n              </a>\r\n            </Link>\r\n            <h2>Requests</h2>\r\n            <Table>\r\n              <Header>\r\n                <Row>\r\n                  <HeaderCell>ID</HeaderCell>\r\n                  <HeaderCell>Description</HeaderCell>\r\n                  <HeaderCell>Recipient</HeaderCell>\r\n                  <HeaderCell>Amount</HeaderCell>\r\n                  <HeaderCell>Approvals</HeaderCell>\r\n                  <HeaderCell>Approve</HeaderCell>\r\n                  <HeaderCell>Finalize</HeaderCell>\r\n                </Row>\r\n              </Header>\r\n              <Body>{this.renderRows()}</Body>\r\n            </Table>\r\n            <h4>Found {this.state.requests.length} requests</h4>\r\n        </div>\r\n        </div>\r\n      </Layout>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewRequests;\r\n"]},"metadata":{},"sourceType":"module"}